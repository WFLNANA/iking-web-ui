(function(p,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(p=typeof globalThis<"u"?globalThis:p||self,e(p.index={},p.Vue))})(this,function(p,e){"use strict";const b=(i,d)=>{if(i.install=s=>{for(const t of[i,...Object.values(d??{})])s.component(t.name,t)},d)for(const[s,t]of Object.entries(d))i[s]=t;return i},Ie="",B=i=>(e.pushScopeId("data-v-21621e0f"),i=i(),e.popScopeId(),i),D={class:"approveProcess",id:"approveProcess"},O=["id"],C={class:"topBlock"},P={class:"left"},I={class:"nodeBg"},L=["src"],w={class:"right"},z={class:"topInfo"},j={key:0},A={key:0,class:"main-text"},$={class:"name"},R={key:0},M={key:0},K={key:1},U=B(()=>e.createElementVNode("span",{class:"red",style:{margin:"0px 5px"}},"退回至",-1)),W={key:1},q={key:0},H={key:0},X={key:1},G={key:1},J=B(()=>e.createElementVNode("div",{class:"main-text"},"抄送人员",-1)),Q={class:"name"},Y={key:0},Z={style:{color:"#000"}},v={class:"blue",style:{"margin-left":"5px","font-size":"12px"}},ee={key:1},te={key:0,class:"blue",style:{"font-size":"12px"}},oe={key:1},ae={key:0,class:"blue",style:{"font-size":"12px"}},le={key:1,class:"blue",style:{"font-size":"12px"}},ne={class:"time"},se={key:0},re={key:1},ie=["onClick"],ce=["onClick"],pe={key:0,class:"opinion"},de={key:0},ke={key:1},me=B(()=>e.createElementVNode("span",null,"添加审批人",-1)),fe={style:{color:"#000","margin-left":"8px"}},_e={key:1,class:"annex"},he=["onClick"],ye={class:"text"},ue={class:"fileName"},ge={class:"size"},Ne={key:2,class:"annexImage"},Be={key:3,class:"approveList"},Ee={class:"nodeBg-list"},Fe=["src"],Te={key:1,class:"ikapprove ikapprove-duihao2 green read"},Se={class:"main-text"},Ve={name:"IkingApprovalProcessDetail"},xe=e.defineComponent({...Ve,props:{local:{type:Boolean,default:!1},defaultStatus:{type:Object,default:()=>({})},defaultNodeType:{type:Object,default:()=>({})},dataList:{type:Array,default:()=>[]},defaultFieldMap:{type:Object,default:()=>({})},returnNode:{type:Array,default:()=>[]},fileUrl:{type:String,default:""}},emits:["preview"],setup(i,{emit:d}){const s=i,t=e.reactive({nodeType:{发起人节点:"1",审批节点:"2",办理节点:"3",抄送节点:"4",...s.defaultNodeType},statusOption:{发起:"1",等待:"2",同意:"3",拒绝:"4",转交:"5",加签:"6",退回:"7",撤销:"8",评论:"9",...s.defaultStatus},listData:[],defaultFile:{id:"id",nodeId:"nodeId",nodeType:"nodeType",nodeTypeName:"nodeTypeName",approveStatus:"approveStatus",approveStatusName:"approveStatusName",originator:"originator",operationTime:"operationTime",approveType:"approveType",approveTypeName:"approveTypeName",multiExecutorTypeName:"multiExecutorTypeName",approveOpinion:"approveOpinion",countersignPer:"countersignPer",backToRecordNodeName:"backToRecordNodeName",attachment:"attachment",attachmentParam:{id:"id",originName:"originName",url:"url",suffix:"suffix",size:"size"},attachmentImg:"attachmentImg",returnNode:"returnNode",returnNodeName:"returnNodeName",lineType:"lineType",allRead:"allRead",read:"read",approvePersonList:[{id:"id",name:"name",approveState:"approveState",approveTime:"approveTime",approveOpinion:"approveOpinion",userAvatar:"userAvatar",accomplish:"accomplish"}],...s.defaultFieldMap}});e.watch(()=>s.dataList,a=>{a&&(e.nextTick(()=>{t.listData=a}),setTimeout(()=>{s.returnNode.length&&y()},500))},{deep:!0}),e.onMounted(()=>{s.dataList.length&&(t.listData=s.dataList,setTimeout(()=>{s.returnNode.length&&y()},500))});const y=()=>{let a=null;for(a of s.returnNode){let l=Array.from(new Array(a[1]+1).keys()).slice(a[0]);e.nextTick(()=>{be(l)})}},be=a=>{var f,_,h;let l=document.createElement("div"),n=document.getElementById("approveProcess"),o=0,c=(f=document.getElementById(`${a[0]}`))==null?void 0:f.offsetWidth,k=(_=document.getElementById(`${a[0]}`))==null?void 0:_.offsetLeft,u=(h=document.getElementById(`${a[0]}`))==null?void 0:h.offsetTop;a.forEach(g=>{let N=document.getElementById(`${g}`);o+=N.offsetHeight}),setTimeout(()=>{l.style.width=c+32+"px",l.style.height=o+"px",l.style.background="#f9f9f9",l.style.position="absolute",l.style.top=u-16+"px",l.style.left=k-16+"px",l.style.zIndex=-1,n==null||n.appendChild(l)})},De=(a,l)=>{var c;let n=(c=t.listData)==null?void 0:c.findIndex(k=>k.lineType=="dashed"),o="";switch(a){case t.statusOption.发起:o="ikapprove-duihao2 green";break;case t.statusOption.等待:o=n==l?"ikapprove-dengdai orange":"";break;case t.statusOption.同意:o="ikapprove-duihao2 green";break;case t.statusOption.拒绝:o="ikapprove-jujue red";break;case t.statusOption.转交:o="ikapprove-zhuanjiao blue";break;case t.statusOption.加签:o="ikapprove-tianjia blue";break;case t.statusOption.退回:o="ikapprove-s_fanhui2 red";break;case t.statusOption.评论:o="ikapprove-pinglun1 blue";break}return`ikapprove ${o}`},Oe=(a,l)=>{let n="";switch(a){case t.nodeType.发起人节点:n="ikapprove-ziyuan";break;case t.nodeType.审批节点:l&&l.length==1?n="ikapprove-ziyuan":n="ikapprove-shenpi";break;case t.nodeType.办理节点:n="ikapprove-bianji";break;case t.nodeType.抄送节点:n="ikapprove-chaosong";break;default:n="ikapprove-ziyuan"}return`ikapprove ${n}`},Ce=a=>{let l="";return a=="jpg"||a=="jpeg"||a=="png"?l="ikapprove-tupian":a=="doc"||a=="docx"?l="ikapprove-WORD":a=="xls"||a=="xlsx"?l="ikapprove-EXCEL":a=="ppt"||a=="pptx"?l="ikapprove-pptcopy":a=="pdf"?l="ikapprove-PDF":a=="rar"||a=="zip"?l="ikapprove-fujian":a=="txt"||a=="zip"?l="ikapprove-TXTCopy":a=="mp3"||a=="wma"||a=="m4a"?l="ikapprove-yinpinwenjian":(a=="avi"||a=="wmv"||a=="mp4"||a=="mov")&&(l="ikapprove-shipinwenjian"),`icon ikapprove ${l}`},Pe=a=>{d("preview",a),s.local||window.open(m(a[t.defaultFile.attachmentParam.url]))},T=(a,l)=>{a.show=!a.show;let n=document.getElementById(`${a[t.defaultFile.nodeId]}`),o=Array.from(n==null?void 0:n.getElementsByClassName("approveList"));for(let c of o)c.style.display=l},m=a=>{let l="";return a.includes("http")||a.includes("https")?l=a:l=s.fileUrl+a,l};return(a,l)=>{const n=e.resolveComponent("el-image");return e.openBlock(),e.createElementBlock("div",D,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.listData,(o,c)=>{var k,u,f,_,h,g,N,S,V,x;return e.openBlock(),e.createElementBlock("div",{class:"approveBlock",id:o[t.defaultFile.nodeId],key:o[t.defaultFile.nodeId]},[e.createElementVNode("div",C,[e.createElementVNode("div",P,[e.createElementVNode("span",I,[((k=o[t.defaultFile.approvePersonList])==null?void 0:k.length)==1&&o[t.defaultFile.approvePersonList][0].userAvatar?(e.openBlock(),e.createElementBlock("img",{key:0,style:{width:"100%",height:"100%","border-radius":"50%"},src:m(o[t.defaultFile.approvePersonList][0].userAvatar),alt:""},null,8,L)):(e.openBlock(),e.createElementBlock("i",{key:1,class:e.normalizeClass(Oe(o[t.defaultFile.nodeType],o[t.defaultFile.approvePersonList]))},null,2)),e.createElementVNode("i",{class:e.normalizeClass(De(o[t.defaultFile.approveStatus],c))},null,2)])]),e.createElementVNode("div",w,[e.createElementVNode("div",z,[e.createElementVNode("div",null,[o[t.defaultFile.nodeType]!=t.nodeType.抄送节点?(e.openBlock(),e.createElementBlock("div",j,[o[t.defaultFile.approveStatus]!=t.statusOption.撤销&&o[t.defaultFile.approveStatus]!=t.statusOption.评论?(e.openBlock(),e.createElementBlock("div",A,e.toDisplayString(o[t.defaultFile.nodeTypeName]),1)):e.createCommentVNode("",!0),e.createElementVNode("div",$,[o[t.defaultFile.lineType]=="solid"?(e.openBlock(),e.createElementBlock("div",R,[e.createElementVNode("span",{style:e.normalizeStyle({color:o[t.defaultFile.approveStatus]==t.statusOption.评论?"#000":""})},e.toDisplayString(o[t.defaultFile.originator]),5),o[t.defaultFile.approveStatusName]&&o[t.defaultFile.approveStatus]!=t.statusOption.发起&&o[t.defaultFile.approveStatus]!=t.statusOption.退回?(e.openBlock(),e.createElementBlock("span",M,e.toDisplayString(o[t.defaultFile.approveStatus]==t.statusOption.评论?" 添加了评论":"（"+o[t.defaultFile.approveStatusName]+"）"),1)):e.createCommentVNode("",!0),o[t.defaultFile.approveStatus]==t.statusOption.退回?(e.openBlock(),e.createElementBlock("span",K,[U,e.createTextVNode(e.toDisplayString(o[t.defaultFile.backToRecordNodeName]),1)])):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("div",W,[((u=o[t.defaultFile.approvePersonList])==null?void 0:u.length)==1?(e.openBlock(),e.createElementBlock("span",q,[e.createTextVNode(e.toDisplayString(o[t.defaultFile.originator])+" ",1),o[t.defaultFile.approveStatus]==t.statusOption.等待?(e.openBlock(),e.createElementBlock("span",H,e.toDisplayString(`（${o[t.defaultFile.approveStatusName]}）`),1)):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("span",X,e.toDisplayString(((f=o[t.defaultFile.approvePersonList])==null?void 0:f.length)+"人"+o[t.defaultFile.approveTypeName]),1))]))])])):(e.openBlock(),e.createElementBlock("div",G,[J,e.createElementVNode("div",Q,[((_=o[t.defaultFile.approvePersonList])==null?void 0:_.length)==1?(e.openBlock(),e.createElementBlock("span",Y,[e.createElementVNode("span",null,[e.createTextVNode("已抄送给 "),e.createElementVNode("span",Z,e.toDisplayString(o[t.defaultFile.approvePersonList][0].userName),1)]),e.createElementVNode("span",v,e.toDisplayString(o[t.defaultFile.approvePersonList][0].status==="END"?"已读":"未读"),1)])):e.createCommentVNode("",!0),((h=o[t.defaultFile.approvePersonList])==null?void 0:h.length)>1?(e.openBlock(),e.createElementBlock("span",ee,[e.createTextVNode(e.toDisplayString(`已抄送${(g=o[t.defaultFile.approvePersonList])==null?void 0:g.length}人`)+" ",1),o[t.defaultFile.allRead]?(e.openBlock(),e.createElementBlock("span",te," 全部已读 ")):(e.openBlock(),e.createElementBlock("span",oe,[o[t.defaultFile.read]?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ae," 全部未读 ")),o[t.defaultFile.read]?(e.openBlock(),e.createElementBlock("span",le,e.toDisplayString(o[t.defaultFile.read])+"人已读 ",1)):e.createCommentVNode("",!0)]))])):e.createCommentVNode("",!0)])]))]),e.createElementVNode("div",ne,[o[t.defaultFile.nodeType]!=t.nodeType.抄送节点?(e.openBlock(),e.createElementBlock("span",se,e.toDisplayString(o[t.defaultFile.operationTime]),1)):e.createCommentVNode("",!0),o[t.defaultFile.nodeType]==t.nodeType.抄送节点&&((N=o[t.defaultFile.approvePersonList])==null?void 0:N.length)>1?(e.openBlock(),e.createElementBlock("span",re,[o!=null&&o.show?(e.openBlock(),e.createElementBlock("i",{key:0,class:"ikapprove ikapprove-a-putongjiantouzhankai",onClick:r=>T(o,"flex")},null,8,ie)):(e.openBlock(),e.createElementBlock("i",{key:1,onClick:r=>T(o,"none"),class:"ikapprove ikapprove-a-putongjiantoushouqi"},null,8,ce))])):e.createCommentVNode("",!0)])])])]),e.createElementVNode("div",{class:"bottomBlock",style:e.normalizeStyle({borderLeft:c==t.listData.length-1?"":`2px ${o[t.defaultFile.lineType]} var(--el-border-color)`})},[o[t.defaultFile.approveOpinion]||o[t.defaultFile.approveStatus]==t.statusOption.加签?(e.openBlock(),e.createElementBlock("div",pe,[o[t.defaultFile.approveOpinion]?(e.openBlock(),e.createElementBlock("span",de,e.toDisplayString(o[t.defaultFile.approveOpinion]),1)):e.createCommentVNode("",!0),o[t.defaultFile.approveStatus]==t.statusOption.加签?(e.openBlock(),e.createElementBlock("span",ke,[me,e.createElementVNode("span",fe,e.toDisplayString(o[t.defaultFile.countersignPer][0].userName),1)])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),(S=o[t.defaultFile.attachment])!=null&&S.length?(e.openBlock(),e.createElementBlock("div",_e,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o[t.defaultFile.attachment],(r,E)=>(e.openBlock(),e.createElementBlock("div",{class:"file-card",key:E,onClick:je=>Pe(r)},[e.createElementVNode("div",{class:e.normalizeClass(Ce(r[t.defaultFile.attachmentParam.suffix]))},null,2),e.createElementVNode("div",ye,[e.createElementVNode("div",ue,e.toDisplayString(r[t.defaultFile.attachmentParam.originName]),1),e.createElementVNode("div",ge,e.toDisplayString((r[t.defaultFile.attachmentParam.size]/1024/1024).toFixed(3))+"MB ",1)])],8,he))),128))])):e.createCommentVNode("",!0),(V=o[t.defaultFile.attachmentImg])!=null&&V.length?(e.openBlock(),e.createElementBlock("div",Ne,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o[t.defaultFile.attachmentImg],(r,E)=>(e.openBlock(),e.createElementBlock("div",{class:"image",key:E},[e.createVNode(n,{src:m(r),fit:"cover","z-index":"9999","zoom-rate":1.2,alt:m(r)},null,8,["src","alt"])]))),128))])):e.createCommentVNode("",!0),(o[t.defaultFile.nodeType]==t.nodeType.抄送节点||o[t.defaultFile.approveStatus]==t.statusOption.等待)&&((x=o[t.defaultFile.approvePersonList])==null?void 0:x.length)>1?(e.openBlock(),e.createElementBlock("div",Be,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o[t.defaultFile.approvePersonList],r=>(e.openBlock(),e.createElementBlock("div",{class:"perBlock",key:r.userName},[e.createElementVNode("span",Ee,[r.userAvatar?(e.openBlock(),e.createElementBlock("img",{key:0,style:{width:"100%",height:"100%","border-radius":"50%"},src:m(r.userAvatar),alt:""},null,8,Fe)):e.createCommentVNode("",!0),e.createElementVNode("span",null,e.toDisplayString(r.userName.slice(-2)),1),r.status==="END"?(e.openBlock(),e.createElementBlock("i",Te)):e.createCommentVNode("",!0)]),e.createElementVNode("div",Se,e.toDisplayString(r.userName),1)]))),128))])):e.createCommentVNode("",!0)],4)],8,O)}),128))])}}}),Le="",F=b(((i,d)=>{const s=i.__vccOpts||i;for(const[t,y]of d)s[t]=y;return s})(xe,[["__scopeId","data-v-21621e0f"]]));p.IKApprovalProcessDetail=F,p.default=F,Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
